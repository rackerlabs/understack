{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "envoy-configs Helm Chart Values",
  "description": "Schema for envoy-configs component values.yaml configuration",
  "type": "object",
  "properties": {
    "gateways": {
      "type": "object",
      "description": "Gateway configurations for external and internal access",
      "properties": {
        "external": {
          "type": "object",
          "description": "External gateway configuration",
          "properties": {
            "name": {
              "type": "string",
              "description": "Name of the external gateway"
            },
            "namespace": {
              "type": "string",
              "description": "Namespace where the external gateway is deployed"
            },
            "className": {
              "type": "string",
              "description": "Gateway class name (e.g., cilium)"
            },
            "serviceAnnotations": {
              "type": "object",
              "description": "Annotations to be placed on the Service generated for this gateway"
            }
          },
          "required": [
            "name",
            "namespace",
            "className"
          ],
          "additionalProperties": false
        },
        "internal": {
          "type": "object",
          "description": "Internal gateway configuration",
          "properties": {
            "name": {
              "type": "string",
              "description": "Name of the internal gateway"
            },
            "namespace": {
              "type": "string",
              "description": "Namespace where the internal gateway is deployed"
            },
            "className": {
              "type": "string",
              "description": "Gateway class name (e.g., cilium)"
            },
            "serviceAnnotations": {
              "type": "object",
              "description": "Annotations to be placed on the Service generated for this gateway"
            }
          },
          "required": [
            "name",
            "namespace",
            "className"
          ],
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "routes": {
      "type": "object",
      "description": "HTTP and TLS routes configurations for Understack services",
      "properties": {
        "http": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "fqdn": {
                "type": "string",
                "description": "Fully qualified domain name for the route"
              },
              "name": {
                "type": "string",
                "description": "Name identifier for the route. If not defined, first part of fqdn is used."
              },
              "namespace": {
                "type": "string",
                "description": "Namespace where the httproute will be installed (same as backend service)"
              },
              "service": {
                "type": "object",
                "description": "Kubernetes service backend configuration for the route",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the Kubernetes service"
                  },
                  "port": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 65535,
                    "description": "Numeric port of the service (not target port)"
                  },
                  "backendType": {
                    "type": "string",
                    "description": "Type of traffic that service expects - 'http' or 'tls'",
                    "enum": ["tls", "http"]
                  }
                },
                "required": [
                  "name",
                  "port"
                ],
                "additionalProperties": false
              },
              "selector": {
                "type": "object",
                "description": "Kubernetes-style label selector (key-value pairs)",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "from": {
                "type": "string",
                "enum": [
                  "Same",
                  "All",
                  "Selector"
                ],
                "description": "Specifies where traffic can originate from"
              },
              "filters": {
                "type": "object",
                "description": "Route filters."
              }
            },
            "required": [
              "fqdn",
              "service"
            ],
            "additionalProperties": false
          }
        },
        "tls": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "fqdn": {
                "type": "string",
                "description": "Fully qualified domain name for the route"
              },
              "name": {
                "type": "string",
                "description": "Name identifier for the route. If not defined, first part of fqdn is used."
              },
              "namespace": {
                "type": "string",
                "description": "Namespace where the httproute will be installed (same as backend service)"
              },
              "service": {
                "type": "object",
                "description": "Kubernetes service backend configuration for the route",
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "Name of the Kubernetes service"
                  },
                  "port": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 65535,
                    "description": "Numeric port of the service (not target port)"
                  }
                },
                "required": [
                  "name",
                  "port"
                ],
                "additionalProperties": false
              },
              "selector": {
                "type": "object",
                "description": "Kubernetes-style label selector (key-value pairs)",
                "additionalProperties": {
                  "type": "string"
                }
              },
              "from": {
                "type": "string",
                "enum": [
                  "Same",
                  "All",
                  "Selector"
                ],
                "description": "Specifies where traffic can originate from"
              }
            },
            "required": [
              "fqdn",
              "service"
            ],
            "additionalProperties": false
          }
        }
      }
    }
  },
  "required": [
    "gateways",
    "routes"
  ],
  "additionalProperties": false
}
