From e7be4c17b8d9119b3beaa926853feb3d6076e475 Mon Sep 17 00:00:00 2001
From: Nidhi Rai <nidhi.rai94@gmail.com>
Date: Thu, 11 Sep 2025 17:05:22 +0530
Subject: [PATCH 2/7] Add SKU field to Redfish inspection

Collect SKU (Service Tag) from Redfish ComputerSystem
and include it in system_vendor inventory data.

This enables downstream tools like Nautobot to access
the Dell Service Tag or other vendor SKU information
during hardware inspection.

The change:
- Safely checks for SKU attribute existence
- Adds SKU to system_vendor dictionary
- Handles missing SKU gracefully
- Includes unit test coverage

Change-Id: I6623fd33b356d6149001c43a7179297a7c8568d8
Signed-off-by: Nidhi Rai <nidhi.rai94@gmail.com>
---
 ironic/drivers/modules/redfish/inspect.py             |  6 ++++++
 .../unit/drivers/modules/redfish/test_inspect.py      | 11 +++++++++++
 2 files changed, 17 insertions(+)

diff --git a/ironic/drivers/modules/redfish/inspect.py b/ironic/drivers/modules/redfish/inspect.py
index df1ff9a91..69f0f0c09 100644
--- a/ironic/drivers/modules/redfish/inspect.py
+++ b/ironic/drivers/modules/redfish/inspect.py
@@ -158,6 +158,12 @@ class RedfishInspect(base.InspectInterface):
         if system.manufacturer:
             system_vendor['manufacturer'] = str(system.manufacturer)
 
+        if system.sku:
+            system_vendor['sku'] = str(system.sku)
+
+        if system.uuid:
+            system_vendor['system_uuid'] = str(system.uuid)
+
         if system_vendor:
             inventory['system_vendor'] = system_vendor
 
diff --git a/ironic/tests/unit/drivers/modules/redfish/test_inspect.py b/ironic/tests/unit/drivers/modules/redfish/test_inspect.py
index 733a2beab..162998e33 100644
--- a/ironic/tests/unit/drivers/modules/redfish/test_inspect.py
+++ b/ironic/tests/unit/drivers/modules/redfish/test_inspect.py
@@ -140,6 +140,9 @@ class RedfishInspectTestCase(db_base.DbTestCase):
         system_mock.manufacturer = 'Sushy Emulator'
 
         system_mock.model = 'PowerEdge R1234'
+        system_mock.sku = 'DELL123456'
+
+        system_mock.uuid = '12345678-1234-1234-1234-12345'
 
         return system_mock
 
@@ -187,12 +190,18 @@ class RedfishInspectTestCase(db_base.DbTestCase):
         expected_product_name = 'PowerEdge R1234'
         expected_serial_number = '123456'
         expected_manufacturer = 'Sushy Emulator'
+        expected_sku = 'DELL123456'
+        expected_system_uuid = '12345678-1234-1234-1234-12345'
         self.assertEqual(expected_product_name,
                          system_vendor['product_name'])
         self.assertEqual(expected_serial_number,
                          system_vendor['serial_number'])
         self.assertEqual(expected_manufacturer,
                          system_vendor['manufacturer'])
+        self.assertEqual(expected_sku,
+                         system_vendor['sku'])
+        self.assertEqual(expected_system_uuid,
+                         system_vendor['system_uuid'])
 
         expected_interfaces = [{'mac_address': '00:11:22:33:44:55',
                                 'name': 'NIC.Integrated.1-1'},
@@ -702,6 +711,8 @@ class RedfishInspectTestCase(db_base.DbTestCase):
         system_mock.model = None
         system_mock.serial_number = None
         system_mock.manufacturer = None
+        system_mock.sku = None
+        system_mock.uuid = None
 
         with task_manager.acquire(self.context, self.node.uuid,
                                   shared=True) as task:
-- 
2.50.1 (Apple Git-155)
