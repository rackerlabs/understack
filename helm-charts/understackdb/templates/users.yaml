{{- range .Values.users }}
---
apiVersion: k8s.mariadb.com/v1alpha1
kind: User
metadata:
  name: "{{ .name }}"
  namespace: {{ .namespace }}
spec:
  mariaDbRef:
    name: {{ $.Values.instanceName }}
    waitForIt: true
  passwordSecretKeyRef:
    name: {{ .name }}-db-password
    key: password
  # This field is immutable and defaults to 10, 0 means unlimited.
  maxUserConnections: {{ .maxUserConnections | default 0 }}
  host: {{ .host | default "%" | quote }}
  retryInterval: {{ .retryInterval | default "5s" }}
  {{- with .extraConfig }}
  {{ . | toYaml | nindent 4 }}
  {{- end }}
{{- end }}
