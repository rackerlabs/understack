- name: Provisioning network config
  ansible.builtin.set_fact:
    provisioning_network_config: >-
      {{
        fabric_wide_layer_3_infrastructure_networks |
        selectattr('name', 'equalto', 'provisioning_network_config') |
        first
      }}


- name: Get infra ucvni-group
  ansible.builtin.uri:
    url: "{{ nautobot_url }}/api/plugins/undercloud-vni/ucvni-groups/?name={{ provisioning_network_config.ucvni_group }}"
    method: GET
    body_format: json
    headers:
      Accept: application/json; version={{ nautobot_api_version }}
      Authorization: Token {{ nautobot_token }}
  register: ucvni_group_response
  check_mode: false
